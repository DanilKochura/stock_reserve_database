# stock_reserve_database - лабораторный работы бо кусу "Базы данных"
Содержание задания


Вариант 1. Резервирование Товаров
На складе хранятся товары, о которых известно шифр товара, его название, единица измерения, цена единицы, установленная поставщиком при доставке товара.
Товары со склада продаются покупателям, о которых известно уникальный номер, название, адрес, контактный телефон, банковские реквизиты (БИК, номер счета, название банка), дата заключения контракта на поставку товаров со склада.
Прежде чем покупатель сможет получить товар, он обязан его зарезервировать, сделав заказ. Заказ должен быть оплачен в течение 3-х дней. После оплаты заказа, товар отпускается со склада. 
В заказе указывается уникальный номер заказа, номер покупателя, дата составления заказа, статус заказа, максимально допустимая дата оплаты и фактическая дата оплаты. Возможные значения статуса заказа:
1-	Заказ составлен, но не оплачен
2-	Заказ оплачен
3-	Заказ просрочен и аннулирован
В одном заказе можно зарезервировать произвольное количество товаров. Для этого формируются строки заказа. Каждая строка содержит шифр товара и его количество. 
По истечении 3-х дней просроченные заказы аннулируются с проставлением в них соответствующего статуса.
Для правильного учета фактически имеющегося на складе товара для товаров предусмотрены следующие атрибуты: количество фактически имеющегося на складе товара, дата его последнего обновления, количество заказанного, но не оплаченного товара, и дата его последнего обновления. 

Простые запросы

1.	Показать все сведения о покупателях, заключивших договора в марте 2020 года.
2.	Показать все сведения о заказах, созданных за последние 60 дней.
3.	Показать, сколько заказов из числа созданных за последние 5 дней, находятся в каждом из возможных статусов.
4.	Показать всех покупателей, у которых номера телефонов имеют в префиксе 495.
5.	Показать общую стоимость неоплаченных заказов для каждого покупателя.
6.	Показать максимальную стоимость оплаченного заказа для каждого покупателя в 2020 году.

Сложные запросы

1.	Выдать данные о покупках со склада в марте 2020 по форме: Шифр покупателя, название покупателя, название товара, общее количество купленного товара.
2.	Покажите шифры и названия товаров, которые покупатель с именем ХХХ покупал в апреле 2020 года. 
3.	Покажите все сведения о самом дорогом товаре на складе
4.	Показать все сведения о покупателях, заключивших долгосрочные договора, но ни разу не сделавших заказ (с помощью левостороннего соединения)
5.	Показать все сведения о покупателях, ни разу не сделавших заказ на покупку товаров в марте 2020 года.
6.	Показать все сведения о покупателе, сделавшем наибольшее количество покупок в 2020 году (с использованием view).

Триггеры и процедуры

	Разработать триггер, который будет срабатывать при изменении статуса заказа. В триггере реализовать увеличение суммы ранее купленных заказов для соответствующего покупателя, если заказ поменял статус с 1 на 2.

	Разработать процедуру, которая будет принимать на вход дату. В процедуре реализовать аннулирование всех заказов, для которых истек срок оплаты.

 
